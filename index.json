[{"content":"ç®€ä»‹ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬ä»‹ç»äº†PS2ä½¿ç”¨çš„å›¾ç‰‡å‹ç¼©ç®—æ³•RLEï¼Œè¿™æ¬¡æˆ‘ä»¬å†æ¥ç ”ç©¶ä¸€ä¸‹å®ƒçš„çº¹ç†è´´å›¾ç¼–ç ç®—æ³•â€”â€”A1B5G5R5ã€‚\nå¯¹äºçº¹ç†æ¥è¯´ï¼Œå¸¸ç”¨çš„å›¾ç‰‡ç¼–ç æ ¼å¼å¦‚jpgæˆ–pngéƒ½ä¸é€‚åˆã€‚å› ä¸ºå›¾ç‰‡æ˜¯ç”±GPUè¯»å–å¹¶è¿›è¡Œæ¸²æŸ“çš„ï¼Œä½ æ€»ä¸èƒ½é€è¿‡å»ä¸€å¼ jpgå›¾ç‰‡ï¼Œè®©GPUè¦è¯»å–å…¶ä¸­ä¸€ä¸ªåƒç´ çš„æ—¶å€™ï¼Œå…ˆæŠŠæ•´ä¸ªå›¾ç‰‡è§£ç å§ï¼Ÿå› æ­¤æœ€ç†æƒ³çš„å›¾ç‰‡æ ¼å¼æ˜¯æœªç»å‹ç¼©çš„ä½å›¾æ ¼å¼ï¼Œå¯ä»¥æ ¹æ®åƒç´ ç‚¹åæ ‡ç›´æ¥è·å–RGBæ•°æ®ã€‚ä»Šå¤©è¦ä»‹ç»çš„A1B5G5R5æ­£æ˜¯è¿™ç§ç¼–ç æ ¼å¼ä¹‹ä¸€ã€‚\nåˆ†æ ä¸Šé¢ä¸¤å¼ çº¹ç†å›¾ç‰‡æ˜¯ä»PS2å­˜æ¡£ä¸­æå–å‡ºæ¥çš„ï¼Œå®ƒä»¬ä»¥ä½å›¾çš„å½¢å¼å‚¨å­˜ï¼Œåƒç´ æ•°é‡ä¸º128x128ã€‚\næ ‡å‡†çš„32ä½ä½å›¾ï¼Œæ¯ä¸ªåƒç´ å ç”¨4å­—èŠ‚æ•°æ®ï¼Œåˆ†åˆ«å‚¨å­˜äº†RGBAå››ä¸ªé€šé“çš„æ•°æ®ã€‚å› æ­¤ä¸Šé¢ä¸¤ä¸ªçº¹ç†å›¾ç‰‡çš„å›¾ç‰‡å¤§å°ä¸º128x128x4å­—èŠ‚ã€‚32ä½RGBAæ¯åƒç´ æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š\nå¯¹äºA1B5G5R5ç¼–ç æ¥è¯´ï¼Œæ¯ä¸ªåƒç´ å ç”¨2å­—èŠ‚æ•°æ®ï¼Œå…¶ä¸­alphaé€šé“å ç”¨1ä½ï¼Œå…¶å®ƒ3ç§é¢œè‰²å„å 5ä½ã€‚æ¯åƒç´ æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š\nå°†A1B5G5R5è§£ç ä¸º32ä½RGBAå¯ä»¥ç”¨ä¸‹å›¾çš„æ–¹æ³•è¿›è¡Œã€‚\nä¼ªä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 while tex_offset \u0026lt; len(self.texture): b = tex_struct.unpack_from(self.texture, tex_offset)[0] out[rgb_tex_offset] = (b \u0026amp; 0x1F) \u0026lt;\u0026lt; 3 # R out[rgb_tex_offset + 1] = ((b \u0026gt;\u0026gt; 5) \u0026amp; 0x1F) \u0026lt;\u0026lt; 3 # G out[rgb_tex_offset + 2] = ((b \u0026gt;\u0026gt; 10) \u0026amp; 0x1F) \u0026lt;\u0026lt; 3 # B rgb_tex_offset += 3 tex_offset += tex_struct.size å¾ˆæ˜æ˜¾å¯ä»¥çœ‹åˆ°ï¼Œå°†32ä½çš„RGBAå›¾ç‰‡ç¼–ç æˆ16ä½çš„A1B5G5R5ï¼Œä¼šä¸¢å¤±æ¯ç§è‰²å½©çš„æœ€å3ä¸ªbitæ•°æ®ï¼Œæ˜¯ä¸€ç§æœ‰æŸç¼–ç æ ¼å¼ï¼Œä½†å¸¦æ¥çš„å¥½å¤„æ˜¯å‹ç¼©æ¯”2:1ï¼Œå›¾ç‰‡ç¼©å°äº†ä¸€åŠã€‚å†é…åˆä¸Šä¸€ç¯‡è®²åˆ°çš„RLEç¼–ç ï¼Œå¯ä»¥è¿›ä¸€æ­¥ç¼©å°å›¾ç‰‡å¤§å°ã€‚\næœ€å æœ€åæ”¾ä¸Šä¸Šé¢ä¸¤ä¸ªçº¹ç†å›¾ç‰‡æ¸²æŸ“åçš„æ•ˆæœï¼Œæœ‰å°ä¼™ä¼´è¿˜è®°å¾—è¿™ä¸¤ä¸ªæ¸¸æˆå—ï¼Ÿ\n","permalink":"https://babyno.top/posts/2023/10/ps2-texture-encoding-algorithm-a1b5g5r5/","summary":"ç®€ä»‹ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬ä»‹ç»äº†PS2ä½¿ç”¨çš„å›¾ç‰‡å‹ç¼©ç®—æ³•RLEï¼Œè¿™æ¬¡æˆ‘ä»¬å†æ¥ç ”ç©¶ä¸€ä¸‹å®ƒçš„çº¹ç†è´´å›¾ç¼–ç ç®—æ³•â€”â€”A1B5G5R5ã€‚ å¯¹äºçº¹ç†æ¥è¯´ï¼Œå¸¸ç”¨","title":"PS2çº¹ç†å›¾ç‰‡ç¼–ç ç®—æ³•A1B5G5R5"},{"content":" RLEç®—æ³•ä»‹ç» RLEï¼ˆRun Length Encodingï¼Œè¡Œç¨‹é•¿åº¦ç¼–ç ï¼‰ç®—æ³•ï¼Œæ˜¯æŠŠæ–‡ä»¶å†…å®¹ç”¨â€œé‡å¤æ¬¡æ•°xæ•°æ®â€çš„å½¢å¼æ¥è¡¨ç¤ºçš„å‹ç¼©æ–¹æ³•ã€‚æ¯”å¦‚ï¼šæœ‰AAAAAABBCDDEEEEEFè¿™æ ·ä¸€æ®µæ•°æ®ï¼Œåœ¨å­—ç¬¦åé¢åŠ ä¸Šé‡å¤å‡ºç°æ¬¡æ•°ï¼Œå°±å¯ä»¥ç”¨6A2B1C2D5E1Fæ¥è¡¨ç¤ºã€‚å¯ä»¥çœ‹åˆ°åŸå§‹æ•°æ®æ˜¯17å­—èŠ‚ï¼Œç¼–ç åæ˜¯12å­—èŠ‚ï¼Œå› æ­¤å‹ç¼©æ˜¯æˆåŠŸçš„ã€‚\nè®©æˆ‘ä»¬å†çœ‹ä¸€ä¸²æ•°æ®ï¼šABCDEï¼Œå¦‚æœæŒ‰ç…§ä¸Šé¢çš„ç®—æ³•ï¼Œç¼–ç åä¸º1A1B1C1D1Eï¼ŒåŸå§‹æ•°æ®æ˜¯5å­—èŠ‚ï¼Œç¼–ç åæ˜¯10å­—èŠ‚ï¼Œæ¯«æ— ç–‘é—®è¿™ç§å‹ç¼©æ–¹å¼æ˜¯å¤±è´¥çš„ã€‚\nä¸ºä»€ä¹ˆç¬¬äºŒç§å­—ç¬¦ä¸²å‹ç¼©ä¼šå¤±è´¥å‘¢ï¼Ÿç»†å¿ƒçš„æœ‹å‹ä¸€å®šçœ‹å‡ºæ¥æ˜¯å› ä¸ºå®ƒçš„å­—ç¬¦é‡å¤å‡ºç°çš„æ¬¡æ•°å¾ˆå°‘ï¼Œå› æ­¤ä½¿ç”¨â€œé‡å¤æ¬¡æ•°xæ•°æ®â€åè€Œå¢åŠ äº†æ•°æ®é•¿åº¦ã€‚é‚£æœ‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªâ€œç¼ºé™·â€å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥ä»‹ç»åœ¨PS2æ¸¸æˆæœºä¸­ï¼Œæ˜¯å¦‚ä½•ä½¿ç”¨RLEç®—æ³•æ¥å‹ç¼©å›¾ç‰‡çš„ã€‚\nRLEç®—æ³•åœ¨PS2ä¸­çš„åº”ç”¨ åœ¨PS2ä¸­ï¼Œå›¾ç‰‡æ–‡ä»¶çš„å‰4ä¸ªå­—èŠ‚æŒ‡ç¤ºäº†å‹ç¼©åæ–‡ä»¶çš„å¤§å°ã€‚æ¥ä¸‹æ¥çš„æ•°æ®æŒ‰ç…§rle_code + æ•°æ®å—çš„æ ¼å¼é‡å¤æ’åˆ—ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨PS2è¿™é‡Œï¼Œrle_codeå’Œæ•°æ®å—ä¸­çš„æ¯ä¸ªæ•°æ®ï¼Œéƒ½æ˜¯2å­—èŠ‚ï¼Œè¿™ç‚¹æ˜¯ä¸å…¶å®ƒä¼ ç»Ÿçš„RLEç®—æ³•æ™®éä¸º1å­—èŠ‚æœ€å¤§çš„ä¸åŒã€‚\nrle_codeçš„æœ€é«˜ä½æ˜¯æ ‡è¯†ä½ï¼Œå¦‚æœè¿™ä¸€ä½æ˜¯1ï¼Œåˆ™è¡¨ç¤ºåé¢ç´§è·Ÿç€çš„æ•°æ®å—æ˜¯â€œéé‡å¤æ•°æ®â€ï¼Œç±»ä¼¼äºä¸Šé¢çš„ABCDEã€‚æ­¤æ—¶å°†0x8000å‡å»rle_codeçš„å7ä½ï¼Œå¾—åˆ°çš„æ˜¯æ•°æ®å—çš„é•¿åº¦ã€‚æ­¤æ—¶åªéœ€å–å‡ºåé¢ç´§è·Ÿçš„è¯¥é•¿åº¦çš„æ•°æ®å—å³å¯ã€‚\nå¦‚æœæ ‡è¯†ä½ä¸º0ï¼Œåˆ™è¡¨ç¤ºåé¢ç´§è·Ÿç€çš„æ•°æ®å—æ˜¯â€œé‡å¤æ•°æ®â€ï¼Œç±»ä¼¼äºAAAAAï¼Œæ­¤æ—¶rle_codeå°±æ˜¯é‡å¤æ¬¡æ•°ï¼Œåªè¦å–å‡ºåé¢ç´§è·Ÿç€çš„ä¸€ä¸ªæ•°æ®å—ï¼Œé‡å¤rle_codeæ¬¡å³å¯ã€‚\nä¼ªä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 while rle_offset \u0026lt; compressed_size: rle_code = rle_code_struct.unpack_from(self.byte_val, rle_offset)[0] rle_offset += 2 if rle_code \u0026amp; 0x8000: next_bytes = 0x8000 - (rle_code ^ 0x8000) texture_buf += self.byte_val[rle_offset: rle_offset + next_bytes * 2] rle_offset += next_bytes * 2 else: times = rle_code if times \u0026gt; 0: next_byte = self.byte_val[rle_offset: rle_offset + 2] for _ in range(times): texture_buf += next_byte rle_offset += 2 æ€»ç»“ å¦‚æœåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œèƒ½è¿ç»­é‡åˆ°å¤§é‡é‡å¤çš„æ•°æ®ï¼ŒRLEç®—æ³•å¯ä»¥æä¾›å¾ˆå¥½çš„å‹ç¼©æ•ˆæœã€‚ä½†å¯¹äºå‡ºç°è¿ç»­çš„â€œéé‡å¤æ•°æ®â€ï¼Œéœ€è¦ä½¿ç”¨æ”¹è‰¯è¿‡çš„ç®—æ³•è¿›è¡Œä¼˜åŒ–ã€‚PS2ä½¿ç”¨çš„æ˜¯ä¼—å¤šæ”¹è‰¯ç®—æ³•çš„ä¸€ç§ï¼Œæ¯”è¾ƒç®€å•ï¼Œä¹Ÿå¾ˆæ–¹ä¾¿åˆå­¦è€…å¯¹è¯¥ç®—æ³•çš„å­¦ä¹ ã€‚\n","permalink":"https://babyno.top/posts/2023/10/rle-algorithm-in-ps2/","summary":"RLEç®—æ³•ä»‹ç» RLEï¼ˆRun Length Encodingï¼Œè¡Œç¨‹é•¿åº¦ç¼–ç ï¼‰ç®—æ³•ï¼Œæ˜¯æŠŠæ–‡ä»¶å†…å®¹ç”¨â€œé‡å¤æ¬¡æ•°xæ•°æ®â€çš„å½¢å¼æ¥è¡¨ç¤ºçš„å‹ç¼©æ–¹æ³•ã€‚æ¯”å¦‚ï¼šæœ‰AAAA","title":"RLEç®—æ³•åœ¨PS2ä¸­çš„åº”ç”¨"},{"content":" ç»è¿‡å‰é¢ä¸€ç³»åˆ—æ–‡ç« çš„é“ºå«ï¼ŒPS2å­˜æ¡£3Då›¾æ ‡çš„æ–‡ä»¶å·²ç»å…¨éƒ¨è§£æå®Œæ¯•ã€‚æœ¬ç¯‡å¼€å§‹å°†ä»‹ç»ä½¿ç”¨å¦‚ä¸‹å·¥å…·å°†3Då›¾æ ‡æ¸²æŸ“å‡ºæ¥ï¼Œå¹¶å°½å¯èƒ½æ¥è¿‘PS2ä¸»æœºåŸç”Ÿçš„æ•ˆæœã€‚\nPython3 PyGame Numpy ModernGL PyGLM 01 åˆå§‹åŒ–PyGameå’ŒModernGL ç¬¬ä¸€æ­¥å…ˆåˆå§‹åŒ–PyGameï¼Œè®¾ç½®çª—å£å¤§å°ä¸º640x480ï¼ŒFPSä¸º60ã€‚å¼€å¯OpenGLæ¸²æŸ“æ¨¡å¼ï¼ŒOpenGLçš„ç‰ˆæœ¬å·è®¾ç½®ä¸º3.3ã€‚\n1 2 3 4 5 6 7 8 9 import pygame as pg pg.init() pg.display.gl_set_attribute(pg.GL_CONTEXT_MAJOR_VERSION, 3) pg.display.gl_set_attribute(pg.GL_CONTEXT_MINOR_VERSION, 3) pg.display.gl_set_attribute(pg.GL_CONTEXT_PROFILE_MASK, pg.GL_CONTEXT_PROFILE_CORE) pg.display.set_mode((640, 480), flags=pg.OPENGL | pg.DOUBLEBUF) self.clock = pg.time.Clock() self.clock.tick(60) æ¥ç€åˆå§‹åŒ–ModernGLï¼Œéå¸¸ç®€å•ï¼Œåªè¦åˆ›å»ºä¸€ä¸ªcontextï¼Œå¼€å¯æ·±åº¦æµ‹è¯•å’Œé¢å‰”é™¤ã€‚\n1 2 3 4 import moderngl as mgl self.ctx = mgl.create_context() self.ctx.enable(flags=mgl.DEPTH_TEST | mgl.CULL_FACE) 02 è·å–é¡¶ç‚¹ã€çº¹ç†ã€æ³•çº¿ç­‰æ•°æ® è¿™éƒ¨åˆ†å†…å®¹åœ¨ä¸Šä¸€ç¯‡è§£æPS2æ¸¸æˆå­˜æ¡£3Då›¾æ ‡æœ‰è¯¦ç»†æè¿°ï¼Œå°±ä¸å±•å¼€äº†ï¼Œè¿™é‡Œåªè´´ä¸€ä¸‹icon.sysçš„æ•°æ®ç»“æ„ä¾›å‚è€ƒã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 struct IconSys { char magic[4]; uint16 unknown; // ignore uint16 subtitle_line_break; uint16 unknown; // ignore uint32 bg_transparency; uint32 bg_color_upper_left[4]; uint32 bg_color_upper_right[4]; uint32 bg_color_lower_left[4]; uint32 bg_color_lower_right[4]; float32 light_pos1[4]; float32 light_pos2[4]; float32 light_pos3[4]; float32 light_color1[4]; float32 light_color2[4]; float32 light_color3[4]; float32 ambient[4]; char subtitle[68]; char icon_file_normal[64]; char icon_file_copy[64]; char icon_file_delete[64]; char zeros[512]; // ignore }; 03 åæ ‡ç³»ç»Ÿ è¿™é‡Œä»¥å³æ‰‹ç³»ç»Ÿåˆ›å»ºåæ ‡ç³»ï¼Œä½†æ˜¯åŸå§‹çš„é¡¶ç‚¹æ˜¯yè½´é¢ å€’çš„ï¼Œå¦‚ä¸‹å›¾Aã€‚å› æ­¤æˆ‘ä»¬ä¹‹åçš„å·¥ä½œå°†åœ¨è½¬æ¢åçš„å›¾Båæ ‡ç³»ä¸‹è¿›è¡Œã€‚ 04 å˜æ¢çŸ©é˜µ è§‚å¯ŸçŸ©é˜µ ä¸Šå›¾Bä¸­ï¼Œæ‘„åƒæœºä½ç½®åœ¨zè½´çš„è´Ÿå»¶ä¼¸æ–¹å‘ï¼Œæˆ‘ä»¬ç¨ç¨å‘yè½´è´Ÿæ–¹å‘ç§»åŠ¨ä¸€å°æ®µè·ç¦»ï¼Œè¿™æ ·å¯ä»¥ä½¿è§†çº¿ä¸æ˜¯å¯¹ç€å›¾æ ‡çš„è„šéƒ¨ï¼Œè€Œæ˜¯ç¨ç¨é ä¸Šä¸€ç‚¹ï¼Œå› æ­¤å°†æ‘„åƒæœºä½ç½®åæ ‡è®¾ä¸º(0, -2, -10)ã€‚å› ä¸ºè¦å°†yè½´é¢ å€’ï¼Œå¯ä»¥ç›´æ¥å°†æ‘„åƒæœºå‘ä¸Šçš„æ–¹å‘è®¾ç½®ä¸ºyè½´çš„è´Ÿæ–¹å‘ã€‚è¿™æ ·ä¸€æ¥lookAtçŸ©é˜µåˆ›å»ºå¦‚ä¸‹ï¼š\n1 2 3 self.position = glm.vec3(0, -2, -10) self.up = glm.vec3(0, -1, 0) self.view = glm.lookAt(self.position, glm.vec3(0, -2, 0), self.up) æŠ•å½±çŸ©é˜µ æŠ•å½±çŸ©é˜µå¯ä»¥ç”¨å¦‚ä¸‹å…¬å¼è·å¾—\n1 self.proj = glm.perspective(glm.radians(50), window_width / window_height, 0.1, 100) æ¨¡å‹çŸ©é˜µ åˆ›å»ºæ¨¡å‹çŸ©é˜µçš„ç›®çš„æ˜¯æ§åˆ¶æ¨¡å‹å¯¹è±¡åœ¨3Dç©ºé—´ä¸­çš„ä½ç½®å˜åŒ–ï¼Œåœ¨è¿™é‡Œæ¨¡å‹å¯¹è±¡éœ€è¦åœ¨ç©ºé—´é‡Œç»•ç€yè½´åš360åº¦çš„æ—‹è½¬ã€‚\n1 2 3 4 5 6 # åˆå§‹åŒ–æ¨¡å‹çŸ©é˜µ self.m_model = glm.mat4() # ä½¿æ¨¡å‹ç»•yè½´æ—‹è½¬ï¼Œè½¬è¿‡çš„è§’åº¦ä¸ºç»è¿‡çš„æ—¶é—´ã€‚ # åˆå§‹åŒ–çš„180åº¦æ˜¯ä¸ºäº†è®©æ¨¡å‹åœ¨å¼€å§‹çš„æ—¶å€™èƒŒå¯¹ç€ç”»é¢ï¼Œæ›´æ¥è¿‘PS2ä¸»æœºçš„è¡Œä¸º m_model = glm.rotate(self.m_model, glm.radians(180) + animation_time / 2, glm.vec3(0, 1, 0)) 05 åˆ›å»ºç€è‰²å™¨ è¿™é‡Œä¸€å…±éœ€è¦åˆ›å»ºå››ä¸ªç€è‰²å™¨\nèƒŒæ™¯é¡¶ç‚¹ç€è‰²å™¨ èƒŒæ™¯ç‰‡æ®µç€è‰²å™¨ Iconé¡¶ç‚¹ç€è‰²å™¨ Iconç‰‡æ®µç€è‰²å™¨ èƒŒæ™¯ç€è‰²å™¨ èƒŒæ™¯ç€è‰²å™¨æ¯”è¾ƒç®€å•ï¼Œåªè¦åˆ›å»ºä¸€ä¸ªè¦†ç›–æ•´ä¸ªåæ ‡ç³»çš„çŸ©å½¢ï¼Œå¹¶ä¸”è®¾ç½®åœ¨ç¦»æ‘„åƒæœºæœ€è¿œçš„é‚£ä¸ªåæ ‡å¹³é¢ä¸Šå³å¯ã€‚å‚è€ƒä¸Šé¢çš„å›¾Bï¼Œè¿™ä¸ªå¹³é¢åº”è¯¥æ˜¯zè½´çš„0.9999ã€‚è¿™ä¸ªçŸ©å½¢çš„å››ä¸ªé¡¶ç‚¹çš„åæ ‡åˆ†åˆ«ä¸º(-1, 1), (-1, -1), (1, -1), (1, 1)ï¼Œå¯¹åº”çš„é¢œè‰²åœ¨icon.sysä¸­å¯ä»¥è§£æå‡ºæ¥ã€‚æ ¹æ®è¿™å››ä¸ªé¡¶ç‚¹å’Œé¢œè‰²ï¼Œå°±å¯ä»¥æ„å»ºèƒŒæ™¯VBOåŠVAOï¼Œè¿™é‡Œä¸åšè¿‡å¤šæè¿°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 // bg.vert #version 330 core in vec2 vertexPos; in vec4 vertexColor; out vec3 fragColor0; void main() { fragColor0 = vertexColor.rgb; gl_Position = vec4(vertexPos.xy, 0.9999, 1.0); } 1 2 3 4 5 6 7 8 9 10 11 12 // bg.frag #version 330 core in vec3 fragColor0; out vec4 fragColor; uniform float alpha0; void main() { fragColor = vec4(fragColor0, alpha0); } Iconç€è‰²å™¨ Iconç€è‰²å™¨ä¼šæ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬å…ˆå°è¯•ç€æŠŠIconé¡¶ç‚¹æ¸²æŸ“å‡ºæ¥ã€‚è¿˜è®°å¾—æ¯ä¸ªå›¾æ ‡æœ‰å¤šä¸ªå½¢çŠ¶å—ï¼Ÿå½¢çŠ¶ä¸åŠ¨ç”»ç›¸å…³ï¼Œæˆ‘ä»¬ç°åœ¨åªå–å…¶ä¸­çš„ä¸€ä¸ªå½¢çŠ¶ç»„æˆVBOå’ŒVAOã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 // icon.vert #version 330 core in vec4 vertexPos; uniform mat4 proj; uniform mat4 view; uniform mat4 model; void main() { gl_Position = proj * view * model * vec4(vertexPos.xyz, 1); } 1 2 3 4 5 6 7 8 // icon.frag #version 330 core out vec4 fragColor; void main() { fragColor = vec4(0, 0, 0, 1); } ä»¥ä¸‹æ˜¯è¿è¡Œä»£ç åçš„æ•ˆæœï¼š\næ·»åŠ çº¹ç† åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šï¼Œå¼•å…¥çº¹ç†åæ ‡å’Œçº¹ç†æ•°æ®ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 // icon.vert #version 330 core in vec4 vertexPos; in vec2 texCoord; in vec4 vertexColor; out vec4 fragColor0; out vec2 uv0; uniform mat4 proj; uniform mat4 view; uniform mat4 model; void main() { uv0 = texCoord; fragColor0 = vertexColor; gl_Position = proj * view * model * vec4(vertexPos.xyz, 1); } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // icon.frag #version 330 core in vec2 uv0; in vec4 fragColor0; out vec4 fragColor; uniform sampler2D texture0; void main() { float alpha = fragColor0.a; vec3 color = fragColor0.rgb * texture(texture0, uv0).rgb; fragColor = vec4(color, alpha); } æ·»åŠ å…‰ç…§ åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šï¼Œå¼•å…¥å…‰æºï¼Œç¯å¢ƒå…‰ä»¥åŠæ³•çº¿æ•°æ®ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 // icon.vert #version 330 core in vec4 vertexPos; in vec2 texCoord; in vec4 vertexColor; in vec4 normal; out vec4 fragColor0; out vec2 uv0; out vec3 normal0; out vec3 fragPos0; uniform mat4 proj; uniform mat4 view; uniform mat4 model; void main() { uv0 = texCoord; fragColor0 = vertexColor; normal0 = mat3(model) * normalize(normal.xyz); gl_Position = proj * view * model * vec4(vertexPos.xyz, 1); fragPos0 = gl_Position.xyz; } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 // icon.frag #version 330 core #define MAX_NUM_TOTAL_LIGHTS 3 in vec2 uv0; in vec4 fragColor0; in vec3 normal0; in vec3 fragPos0; out vec4 fragColor; struct Light { vec4 pos; vec4 color; }; uniform sampler2D texture0; uniform vec4 ambient; uniform Light lights[MAX_NUM_TOTAL_LIGHTS]; void main() { vec3 normal = normalize(normal0); float alpha = fragColor0.a; vec3 color = fragColor0.rgb * texture(texture0, uv0).rgb; vec3 diffuse = vec3(0.0, 0.0, 0.0); for (int i = 0; i \u0026lt; MAX_NUM_TOTAL_LIGHTS; i++) { vec3 lightDir = normalize(lights[i].pos.xyz - fragPos0); float diff = max(dot(lightDir, normal), 0.0); diffuse += diff * lights[i].color.rgb; } color = (ambient.rgb + diffuse) * color; fragColor = vec4(color, alpha); } åŠ¨ç”»æ•ˆæœ åŠ¨ç”»æ•ˆæœæ˜¯è®©ç€è‰²å™¨æŒ‰ç…§æ—¶é—´æ¸²æŸ“ä¸åŒå½¢çŠ¶çš„é¡¶ç‚¹æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ªè®¡æ—¶å™¨å’Œä¸€ä¸ªè®¡æ•°å™¨ï¼Œä»¥ç¡®å®šå½“å‰æ—¶é—´åº”è¯¥æ¸²æŸ“å“ªä¸ªå½¢çŠ¶çš„é¡¶ç‚¹ã€‚\nframe_length å®ŒæˆåŠ¨ç”»æ•ˆæœéœ€è¦çš„å®é™…å¸§æ•°ï¼Œå®é™…å¸§ç‡ç­‰äº60FPS animation_time åŠ¨ç”»è¿è¡Œæ—¶é—´ anim_speed åŠ¨ç”»æ’­æ”¾é€Ÿåº¦ frame_length / animation_shapes ä¸€ä¸ªå½¢çŠ¶åŒ…å«å¤šå°‘å¸§ 1 2 3 4 animation_time = time.time() - self.start_time curr_frame = int(animation_time * self.window.fps * self.icon.anim_speed) % self.icon.frame_length curr_shape = int(curr_frame // (self.icon.frame_length / self.icon.animation_shapes)) ä½¿åŠ¨ç”»å¹³æ»‘è¿‡æ¸¡ ä½¿åŠ¨ç”»å¹³æ»‘è¿‡æ¸¡éœ€è¦ä½¿ç”¨ç€è‰²å™¨çš„é¡¶ç‚¹æ’å€¼æŠ€æœ¯ã€‚æˆ‘ä»¬åœ¨å‘é€ç€è‰²å™¨é¡¶ç‚¹çš„æ—¶å€™ï¼Œå°†å½“å‰å½¢çŠ¶å’Œä¸‹ä¸€ä¸ªå½¢çŠ¶çš„é¡¶ç‚¹æ•°æ®åŒæ—¶å‘é€ã€‚è¿™æ ·å†æ ¹æ®æ—¶é—´å› å­ï¼Œç€è‰²å™¨ä¼šè‡ªåŠ¨è®¡ç®—ä¸¤ä¸ªå½¢çŠ¶ä¹‹é—´çš„é¡¶ç‚¹ã€‚\ntween_factor è®¡ç®—å½“å‰æ—¶é—´æˆ³åœ¨æ•´ä¸ªå½¢çŠ¶ä¸­æ‰€å å¸§çš„ç™¾åˆ†æ¯” 1 2 curr_frame_in_shape = curr_frame % frames_in_shape / frames_in_shape tween_factor = glm.float32(curr_frame_in_shape) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 // icon.vert #version 330 core in vec4 vertexPos; in vec2 texCoord; in vec4 vertexColor; in vec4 nextVertexPos; in vec4 normal; out vec4 fragColor0; out vec2 uv0; out vec3 normal0; out vec3 fragPos0; uniform mat4 proj; uniform mat4 view; uniform mat4 model; uniform float tweenFactor; void main() { uv0 = texCoord; fragColor0 = vertexColor; normal0 = mat3(model) * normalize(normal.xyz); vec4 basePos = vec4(mix(vertexPos.xyz, nextVertexPos.xyz, tweenFactor), 1.0); gl_Position = proj * view * model * basePos; fragPos0 = gl_Position.xyz; } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 // icon.frag #version 330 core #define MAX_NUM_TOTAL_LIGHTS 3 in vec2 uv0; in vec4 fragColor0; in vec3 normal0; in vec3 fragPos0; out vec4 fragColor; struct Light { vec4 pos; vec4 color; }; uniform sampler2D texture0; uniform vec4 ambient; uniform Light lights[MAX_NUM_TOTAL_LIGHTS]; void main() { vec3 normal = normalize(normal0); float alpha = fragColor0.a; vec3 color = fragColor0.rgb * texture(texture0, uv0).rgb; vec3 diffuse = vec3(0.0, 0.0, 0.0); for (int i = 0; i \u0026lt; MAX_NUM_TOTAL_LIGHTS; i++) { vec3 lightDir = normalize(lights[i].pos.xyz - fragPos0); float diff = max(dot(lightDir, normal), 0.0); diffuse += diff * lights[i].color.rgb; } color = (ambient.rgb + diffuse) * color; fragColor = vec4(color, alpha); } æœ€ç»ˆæ•ˆæœï¼š\n06 å°¾å£° æ‰€æœ‰ä»£ç å‡å¯åœ¨ https://github.com/caol64/ps2mc-browser ä¸‹è½½åˆ°ã€‚åœ¨æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¹Ÿæåˆ°äº†è¿™ä¸ªç³»åˆ—çš„åˆ›ä½œåˆè¡·ï¼šä¸ºäº†çºªå¿µé€å»çš„é’æ˜¥ï¼Œä»¥åŠå¯¹æŠ€æœ¯æ°¸ä¸ç£¨ç­çš„çƒ­æƒ…ã€‚åœ¨æ­¤æ”¶å°¾ï¼Œä¹Ÿç®—è¿˜äº†å¹´å°‘æ—¶çš„ä¸€ä¸ªæ¢¦æƒ³ã€‚\n07 å‚è€ƒæ–‡çŒ® gothi - icon.sys format Martin Akesson - PS2 Icon Format v0.5 Florian MÃ¤rkl - mymcplus Ross Ridge - PlayStation 2 Memory Card File System ","permalink":"https://babyno.top/posts/2023/10/rendering-ps2-3d-icon/","summary":"ç»è¿‡å‰é¢ä¸€ç³»åˆ—æ–‡ç« çš„é“ºå«ï¼ŒPS2å­˜æ¡£3Då›¾æ ‡çš„æ–‡ä»¶å·²ç»å…¨éƒ¨è§£æå®Œæ¯•ã€‚æœ¬ç¯‡å¼€å§‹å°†ä»‹ç»ä½¿ç”¨å¦‚ä¸‹å·¥å…·å°†3Då›¾æ ‡æ¸²æŸ“å‡ºæ¥ï¼Œå¹¶å°½å¯èƒ½æ¥è¿‘PS2ä¸»æœºåŸç”Ÿ","title":"ä½¿ç”¨Pythonå’ŒOpenGLæ¸²æŸ“PS2å­˜æ¡£3Då›¾æ ‡"},{"content":" çœ‹åˆ°è¿™ä¸ªå›¾ç‰‡ï¼Œå¯¹äºç†Ÿæ‚‰PS2çš„è€ç©å®¶æ¥è¯´åº”è¯¥ä¸ä¼šé™Œç”Ÿã€‚å®ƒæ˜¯PS2è®°å¿†å¡ç®¡ç†ç•Œé¢ä¸­çš„æ¸¸æˆå­˜æ¡£3Då›¾æ ‡ã€‚æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä»å­˜æ¡£æ–‡ä»¶é‡Œè§£æå‡ºè¿™ä¸ªæ´»åŠ¨çš„å°äººã€‚\n01 è§£æç›®æ ‡ Aï¼šæˆ‘ä»¬èƒ½ä»å­˜æ¡£æ–‡ä»¶ä¸­è§£æåˆ°ä»€ä¹ˆï¼Ÿ\nå›¾æ ‡æ¨¡å‹çš„æ‰€æœ‰é¡¶ç‚¹ã€æ³•çº¿ å›¾æ ‡æ¨¡å‹çš„åŠ¨ä½œå¸§ å…‰ç…§ çº¹ç†åŠçº¹ç†åæ ‡ èƒŒæ™¯é¢œè‰²åŠé€æ˜åº¦ Bï¼šæˆ‘ä»¬éœ€è¦åšä»€ä¹ˆï¼Ÿ\nç¼–å†™ç€è‰²å™¨æ¸²æŸ“èƒŒæ™¯å’Œå›¾æ ‡ å°†å›¾æ ‡æ¨¡å‹çš„åŠ¨ä½œå¸§ç»„æˆåŠ¨ç”» æ„å»ºæ¨¡å‹çŸ©é˜µã€è§†å›¾çŸ©é˜µã€é€è§†çŸ©é˜µï¼Œä½¿æ˜¾ç¤ºæ¥è¿‘PS2åŸç”Ÿæ•ˆæœ å®Œæˆæ•´ä¸ªåŠŸèƒ½ä¼°è®¡éœ€è¦ä¸¤ç¯‡æ–‡ç« ï¼Œæœ¬ç¯‡ä¸»è¦ä»‹ç»Aã€‚\n02 è§£æicon.sys ä¸Šä¸€ç¯‡æˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•å¯¼å‡ºæ¸¸æˆçš„å­˜æ¡£æ–‡ä»¶ï¼Œäº‹å®ä¸Šæ¯ä¸ªå­˜æ¡£é‡Œéƒ½ä¼šæœ‰ä¸€ä¸ªicon.sysçš„æ–‡ä»¶ï¼Œè¿™ä¸ªå¯ä»¥çœ‹ä½œå›¾æ ‡çš„é…ç½®æ–‡ä»¶ã€‚icon.sysæ˜¯ä¸€ä¸ªå›ºå®šå¤§å°ï¼ˆ964å­—èŠ‚ï¼‰çš„æ–‡ä»¶ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š\noffset length description 0 byte[4] magicï¼šPS2D 4 uint16 0 6 uint16 æ¸¸æˆæ ‡é¢˜æ¢è¡Œç¬¦æ‰€åœ¨ä½ç½®ï¼Œæ³¨1 8 uint32 0 12 uint32 bg_transparencyï¼ŒèƒŒæ™¯é€æ˜åº¦ï¼Œ0-255 16 uint32[4] bg_colorï¼ŒèƒŒæ™¯å·¦ä¸Šè§’é¢œè‰²ï¼ˆRGB-ï¼Œ0-255ï¼‰ 32 uint32[4] bg_colorï¼ŒèƒŒæ™¯å³ä¸Šè§’é¢œè‰²ï¼ˆRGB-ï¼Œ0-255ï¼‰ 48 uint32[4] bg_colorï¼ŒèƒŒæ™¯å·¦ä¸‹è§’é¢œè‰²ï¼ˆRGB-ï¼Œ0-255ï¼‰ 64 uint32[4] bg_colorï¼ŒèƒŒæ™¯å³ä¸‹è§’é¢œè‰²ï¼ˆRGB-ï¼Œ0-255ï¼‰ 80 uint32[4] light_pos1ï¼Œå…‰æº1ï¼ˆXYZ-ï¼Œ0-1ï¼‰ 96 uint32[4] light_pos2ï¼Œå…‰æº2ï¼ˆXYZ-ï¼Œ0-1ï¼‰ 112 uint32[4] light_pos3ï¼Œå…‰æº3ï¼ˆXYZ-ï¼Œ0-1ï¼‰ 128 uint32[4] light_color1ï¼Œå…‰æº1é¢œè‰²ï¼ˆRGB-ï¼Œ0-1ï¼‰ 144 uint32[4] light_color2ï¼Œå…‰æº2é¢œè‰²ï¼ˆRGB-ï¼Œ0-1ï¼‰ 160 uint32[4] light_color3ï¼Œå…‰æº3é¢œè‰²ï¼ˆRGB-ï¼Œ0-1ï¼‰ 176 uint32[4] ambientï¼Œç¯å¢ƒå…‰ï¼ˆRGB-ï¼Œ0-1ï¼‰ 192 byte[68] sub_titleï¼Œæ¸¸æˆæ ‡é¢˜ï¼ˆç©ºå­—ç¬¦ç»“å°¾, S-JISç¼–ç ï¼‰ 260 byte[64] icon_file_normalï¼Œæ™®é€šå›¾æ ‡æ–‡ä»¶åï¼ˆç©ºå­—ç¬¦ç»“å°¾ï¼‰ï¼Œæ³¨2 324 byte[64] icon_file_copyï¼Œæ‹·è´å›¾æ ‡æ–‡ä»¶åï¼ˆç©ºå­—ç¬¦ç»“å°¾ï¼‰ï¼Œæ³¨2 388 byte[64] icon_file_deleteï¼Œåˆ é™¤å›¾æ ‡æ–‡ä»¶åï¼ˆç©ºå­—ç¬¦ç»“å°¾ï¼‰ï¼Œæ³¨2 452 byte[512] å…¨0 æ³¨1ï¼šæ¸¸æˆæ ‡é¢˜sub_titleæ˜¾ç¤ºä¸º2è¡Œï¼Œè¯¥å€¼å³ä¸ºåœ¨æ ‡é¢˜çš„ç¬¬å‡ ä¸ªå­—èŠ‚æ¢è¡Œï¼Œå¦‚å›¾ï¼š\næ³¨2ï¼šæ¯ä¸ªæ¸¸æˆå­˜æ¡£å¯ä»¥å¯¹åº”3ä¸ªå›¾æ ‡iconæ–‡ä»¶ï¼Œåˆ†åˆ«åœ¨ä¸åŒåœºæ™¯æ˜¾ç¤ºã€‚\nå¯ä»¥çœ‹åˆ°icon.sysæ–‡ä»¶é‡Œä¸»è¦æä¾›äº†èƒŒæ™¯ã€å…‰ç…§ç­‰æ•°æ®ï¼Œå¦å¤–ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„éƒ¨åˆ†æ˜¯3då›¾æ ‡æ‰€åœ¨çš„æ–‡ä»¶åã€‚\n03 è§£æiconæ–‡ä»¶ ä¸åƒicon.sysæ–‡ä»¶ï¼Œæ¯ä¸ªæ¸¸æˆçš„iconæ–‡ä»¶æ˜¯ä¸ç¡®å®šçš„ï¼Œå¤§å°ä¸ç¡®å®šï¼Œæ•°é‡ä¹Ÿä¸ç¡®å®šï¼Œä½†è‡³å°‘ä¼šæœ‰1ä¸ªã€‚æœ‰çš„æ¸¸æˆæ‹·è´å›¾æ ‡å’Œåˆ é™¤å›¾æ ‡ä¸æ™®é€šå›¾æ ‡å…±ç”¨ä¸€ä¸ªå›¾æ ‡ã€‚\n3.1 æ–‡ä»¶ç»“æ„ åç§° è¯´æ˜ Iconå¤´ å›ºå®šå¤§å°ï¼Œ20ä¸ªå­—èŠ‚ é¡¶ç‚¹æ®µ ä¿å­˜å›¾æ ‡æ¨¡å‹çš„æ‰€æœ‰é¡¶ç‚¹å’Œæ³•çº¿æ•°æ® åŠ¨ç”»æ®µ ä¿å­˜å›¾æ ‡æ¨¡å‹åŠ¨ç”»å¸§ä¿¡æ¯ çº¹ç†æ®µ ä¿å­˜å›¾æ ‡æ¨¡å‹çº¹ç† 3.2 Iconå¤´ Iconå¤´å­˜å‚¨äº†æˆ‘ä»¬è§£ç ä¸åŒæ•°æ®æ®µæ‰€éœ€çš„æ‰€æœ‰é‡è¦ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š\nâ€œé¡¶ç‚¹æ®µâ€ä¸­åŒ…å«çš„é¡¶ç‚¹æ•°é‡ä»¥åŠåŠ¨ç”»å½¢çŠ¶çš„æ•°é‡ çº¹ç†æ•°æ®æ˜¯å¦ç»è¿‡å‹ç¼© åœ¨å›¾æ ‡æ–‡ä»¶ä¸­ï¼ŒIconå¤´æ€»æ˜¯ä½äºåç§»é‡ 0 å¤„ã€‚ä»¥ä¸‹æ˜¯Iconå¤´ç»“æ„ï¼š\nOffset Length Description 0000 uint32 magicï¼š0x010000 0004 uint32 animation_shapesï¼ŒåŠ¨ç”»å½¢çŠ¶ï¼Œæ³¨1 0008 uint32 tex_typeï¼Œçº¹ç†ç±»å‹ï¼Œæ³¨2 0012 uint32 æœªçŸ¥ï¼Œå›ºå®šå€¼0x3F800000 0016 uint32 vertex_countï¼Œé¡¶ç‚¹æ•°é‡ï¼Œå¿…å®šæ˜¯3çš„å€æ•° æ³¨1ï¼šå›¾æ ‡æ¨¡å‹æœ‰å‡ å¥—ä¸åŒçš„é¡¶ç‚¹æ•°æ®ï¼Œå¯¹åº”ä¸åŒçš„åŠ¨ä½œï¼Œç§°ä¹‹ä¸ºâ€œå½¢çŠ¶â€ã€‚å°†ä¸åŒçš„å½¢çŠ¶å¾ªç¯æ¸²æŸ“ï¼Œå³å¯å½¢æˆåŠ¨ç”»æ•ˆæœã€‚\næ³¨2ï¼šâ€œçº¹ç†ç±»å‹â€è¿™éƒ¨åˆ†å°šä¸æ˜ç¡®ï¼Œè¯¥å€¼æ˜¯4å­—èŠ‚æ•´å½¢ï¼Œæˆ‘æ€»ç»“å‡ºæ¥æ¯ä¸ªä½ç›¸åº”çš„åŠŸèƒ½å¦‚ä¸‹è¡¨ï¼Œæœªå¿…æ­£ç¡®ï¼š\nmask Description 0001 æœªçŸ¥ 0010 æœªçŸ¥ 0100 å›¾æ ‡æ–‡ä»¶ä¸­å­˜åœ¨çº¹ç†æ•°æ®ï¼Œæœ‰äº›æ¸¸æˆï¼ˆå¦‚ICOï¼‰æ²¡æœ‰çº¹ç†æ•°æ®ï¼Œå›¾æ ‡å…¨é»‘ 1000 å›¾æ ‡æ–‡ä»¶ä¸­çš„çº¹ç†æ•°æ®æ˜¯è¢«å‹ç¼©è¿‡çš„ 3.3 é¡¶ç‚¹æ®µ PS2 å›¾æ ‡ä¸­çš„å¤šè¾¹å½¢æ€»æ˜¯ç”±ä¸‰ä¸ªé¡¶ç‚¹å½¢æˆçš„ä¸‰è§’å½¢ç»„æˆã€‚ç”±äºé¡¶ç‚¹æ˜¯æŒ‰ä¸€å®šè§„å¾‹æ’åˆ—çš„ï¼Œå› æ­¤åªéœ€æŒ‰ç…§è§„å¾‹è¯»å–é¡¶ç‚¹æ•°æ®ï¼Œå°±èƒ½è½»æ¾æ„å»ºå¤šè¾¹å½¢ã€‚åˆ©ç”¨OpenGLæˆ–ç±»ä¼¼å·¥å…·æ¸²æŸ“è¿™äº›æ•°æ®ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªæ¼‚äº®çš„å›¾æ ‡çº¿æ¡†ã€‚\nâ€œé¡¶ç‚¹æ®µâ€åŒ…å«å›¾æ ‡ä¸­æ‰€æœ‰é¡¶ç‚¹çš„æ•°æ®ã€‚æ¯ä¸ªé¡¶ç‚¹æ•°æ®åŒ…å«ä¸€ç»„é¡¶ç‚¹åæ ‡ã€æ³•çº¿åæ ‡ã€çº¹ç†åæ ‡ä»¥åŠä¸€ç»„RGBAæ•°æ®ï¼Œå› æ­¤ï¼Œæ‹¥æœ‰mä¸ªé¡¶ç‚¹å’Œ nä¸ªå½¢çŠ¶çš„â€œé¡¶ç‚¹æ®µâ€æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š\né¡¶ç‚¹åæ ‡ æ¯ä¸ªé¡¶ç‚¹åæ ‡å ç”¨8å­—èŠ‚ï¼Œç»“æ„å¦‚ä¸‹ï¼š\nOffset Length Description 0000 int16 Xåæ ‡ï¼Œä½¿ç”¨æ—¶éœ€é™¤ä»¥4096 0002 int16 Yåæ ‡ï¼Œä½¿ç”¨æ—¶éœ€é™¤ä»¥4096 0004 int16 Zåæ ‡ï¼Œä½¿ç”¨æ—¶éœ€é™¤ä»¥4096 0006 uint16 æœªçŸ¥ æ³•çº¿åæ ‡ æ¯ä¸ªæ³•çº¿åæ ‡ä¸é¡¶ç‚¹åæ ‡æ•°æ®ç»“æ„ä¸€è‡´ã€‚\nçº¹ç†åæ ‡ æ¯ä¸ªçº¹ç†åæ ‡å ç”¨4å­—èŠ‚ï¼Œç»“æ„å¦‚ä¸‹ï¼š\nOffset Length Description 0000 int16 Uåæ ‡ï¼Œä½¿ç”¨æ—¶éœ€é™¤ä»¥4096 0002 int16 Våæ ‡ï¼Œä½¿ç”¨æ—¶éœ€é™¤ä»¥4096 é¡¶ç‚¹RGBA æ¯ä¸ªé¡¶ç‚¹é¢œè‰²å ç”¨4å­—èŠ‚ï¼Œç»“æ„å¦‚ä¸‹ï¼š\nOffset Length Description 0000 uint8 Rï¼Œ0-255 0001 uint8 Gï¼Œ0-255 0002 uint8 Bï¼Œ0-255 0003 uint8 Aï¼Œ0-255 3.4 åŠ¨ç”»æ®µ å¾ˆé—æ†¾å…³äºâ€œåŠ¨ç”»æ®µâ€é‡Œçš„å¤§éƒ¨åˆ†å†…å®¹ï¼Œæˆ‘è¿˜æ²¡å®Œå…¨ææ‡‚å«ä¹‰ã€‚ä¸è¿‡ä¸ç”¨å¤ªåœ¨æ„ï¼Œåˆ©ç”¨â€œé¡¶ç‚¹åæ ‡æ’å€¼â€ï¼Œä»ç„¶å¯ä»¥å®ŒæˆåŠ¨ç”»åŠ¨ä½œã€‚\nä»¥ä¸‹æ˜¯â€œåŠ¨ç”»æ®µâ€çš„æ•°æ®ç»“æ„ï¼š\nâ€œåŠ¨ç”»æ®µâ€åŒ…å«â€œåŠ¨ç”»å¤´â€å’Œè‹¥å¹²â€œåŠ¨ç”»å¸§â€ï¼Œæ¯ä¸ªâ€œåŠ¨ç”»å¸§â€åŒ…å«è‹¥å¹²â€œå…³é”®å¸§â€ã€‚\nåŠ¨ç”»å¤´ â€œåŠ¨ç”»å¤´â€ç»“æ„å¦‚ä¸‹ï¼š\nOffset Length Description 0000 uint32 magicï¼š0x01 0004 uint32 frame lengthï¼šâ€œåŠ¨ç”»å¸§â€å®Œæˆä¸€ä¸ªå¾ªç¯æ‰€éœ€çš„â€œæ’­æ”¾å¸§â€ï¼Œæ ¹æ®è¿™ä¸ªå€¼å¯ä»¥è®¡ç®—å‡ºæ¯ä¸ªâ€œåŠ¨ç”»å¸§â€å¯¹åº”çš„â€œæ’­æ”¾å¸§â€æ•°é‡ 0008 float32 anim speedï¼šæ’­æ”¾é€Ÿåº¦ï¼Œä½œç”¨æœªçŸ¥ 0012 uint32 play offsetï¼šèµ·å§‹æ’­æ”¾å¸§ï¼Œä½œç”¨æœªçŸ¥ 0016 uint32 frame countï¼šâ€œåŠ¨ç”»æ®µâ€ä¸€å…±æœ‰å‡ ä¸ªâ€œåŠ¨ç”»å¸§â€ï¼Œä¸€èˆ¬ä¸€ä¸ªâ€œå½¢çŠ¶â€å¯¹åº”ä¸€ä¸ªâ€œåŠ¨ç”»å¸§â€ å¸§æ•°æ®Frame Data â€œå¸§æ•°æ®â€ç›´æ¥ä½äºâ€œåŠ¨ç”»å¤´â€ä¹‹åã€‚\nOffset Type Description 0000 u32 Shape id 0004 u32 Number of keys 0008 u32 UNKNOWN 0012 u32 UNKNOWN å…³é”®å¸§Frame Key Offset Type Description 0000 f32 Time 0004 f32 Value 3.5 çº¹ç†æ®µ çº¹ç†æ˜¯åƒç´ ä¸º128x128çš„å›¾ç‰‡ï¼Œä½¿ç”¨TIMå›¾åƒæ ¼å¼è¿›è¡Œç¼–ç ã€‚æ ¹æ®Iconå¤´é‡Œçš„tex_typeå­—æ®µï¼Œçº¹ç†åˆ†ä¸ºæœªå‹ç¼©å’Œå‹ç¼©ä¸¤ç§ç±»å‹ã€‚\næœªå‹ç¼©çº¹ç† æœªå‹ç¼©çº¹ç†çš„åƒç´ æ ¼å¼ä¸ºBGR555ï¼Œå…¶ä¸­Bã€Gã€Rå„å ç”¨5bitï¼Œæ€»å…±15bitï¼Œå ç”¨2å­—èŠ‚ï¼ˆ1ä¸ªbitå†—ä½™ï¼‰ã€‚å¦‚å›¾ï¼š\n1 2 3 4 High-order byte: Low-order byte: X B B B B B G G G G G R R R R R X = Don\u0026#39;t care, R = Red, G = Green, B = Blue å› æ­¤åŸå§‹å›¾ç‰‡å¤§å°å›ºå®šä¸º128x128x2å­—èŠ‚ã€‚å¦‚æœéœ€å°†å®ƒçš„åƒç´ æ ¼å¼è½¬ä¸ºRGB24ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š\n1 2 High-order byte: Middle-order byte: Low-order byte: R R R R R 0 0 0 G G G G G 0 0 0 B B B B B 0 0 0 å°†5bitçš„è‰²å½©å€¼è½¬ä¸º8bitæ—¶ï¼Œéœ€å°†ä½3ä½è¡¥0ã€‚ç»è¿‡ä¸Šè¿°è½¬æ¢ï¼Œæ¯åƒç´ å­—èŠ‚æ•°å˜ä¸º3å­—èŠ‚ã€‚åŒç†ä¹Ÿå¯å°†æ ¼å¼è½¬ä¸ºRGBA32ï¼Œæ¯åƒç´ å­—èŠ‚æ•°å˜ä¸º4å­—èŠ‚ã€‚\nå‹ç¼©çº¹ç† å‹ç¼©çº¹ç†ä½¿ç”¨éå¸¸ç®€å•çš„RLEç®—æ³•è¿›è¡Œå‹ç¼©ã€‚ç¬¬ä¸€ä¸ªu32æ˜¯å‹ç¼©çº¹ç†æ•°æ®çš„å¤§å°ã€‚å…¶åçš„æ•°æ®å§‹ç»ˆä¸ºu16çš„rle_codeå’Œrle_dataäº¤æ›¿å‡ºç°ï¼Œç›´åˆ°ç»“æŸã€‚ rle_dataæœ‰ä¸¤ä¸ªå˜é‡ï¼šdataæ•°é‡xå’Œé‡å¤æ¬¡æ•°yã€‚rle_codeä½œä¸ºè®¡æ•°å™¨å­˜åœ¨ï¼Œå¦‚æœå°äº0xFF00ï¼Œåˆ™x = 1ï¼Œy = rle_codeï¼›å¦‚æœå¤§äºç­‰äº0xFF00ï¼Œåˆ™x = (0x10000 - rle_code)ï¼Œy = 1ã€‚å¦‚ä¸‹å›¾ã€‚\nå°†å‹ç¼©çº¹ç†è§£å‹åï¼Œå†æ ¹æ®ä¸Šä¸€èŠ‚çš„å†…å®¹å³å¯è½¬æ¢ä¸ºRGB24æˆ–RGBA32çš„å›¾ç‰‡ã€‚\n04 ç»“å°¾ è‡³æ­¤ä¸ºæ­¢å›¾æ ‡çš„ç›¸å…³æ–‡ä»¶å·²ç»è§£æå®Œæ¯•äº†ï¼Œä¸‡äº‹ä¿±å¤‡åªæ¬ ä¸œé£ï¼Œä¸‹ä¸€ç¯‡æˆ‘ä»¬å³å°†å¼€å§‹æ¸²æŸ“æ¨¡å¼ï¼Œä½¿ç”¨PyGameå’ŒModernGLå°†æ¸²æŸ“åŠ¨ç”»æ˜¾ç¤ºå‡ºæ¥ã€‚\n05 å‚è€ƒèµ„æ–™ gothi - icon.sys format Martin Akesson - PS2 Icon Format v0.5 ","permalink":"https://babyno.top/posts/2023/10/parsing-ps2-3d-icon/","summary":"çœ‹åˆ°è¿™ä¸ªå›¾ç‰‡ï¼Œå¯¹äºç†Ÿæ‚‰PS2çš„è€ç©å®¶æ¥è¯´åº”è¯¥ä¸ä¼šé™Œç”Ÿã€‚å®ƒæ˜¯PS2è®°å¿†å¡ç®¡ç†ç•Œé¢ä¸­çš„æ¸¸æˆå­˜æ¡£3Då›¾æ ‡ã€‚æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä»å­˜æ¡£æ–‡ä»¶é‡Œè§£æå‡º","title":"è§£æPS2æ¸¸æˆå­˜æ¡£3Då›¾æ ‡"},{"content":"ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬è§£æäº†PS2å­˜å‚¨å¡çš„æ–‡ä»¶ç³»ç»Ÿï¼Œè¿™æ¬¡ç›´æ¥å®æˆ˜ï¼Œç¼–å†™pythonä»£ç å¯¼å‡ºæŒ‡å®šçš„æ¸¸æˆå­˜æ¡£ã€‚æœ¬ç¯‡æ–‡ç« å®Œæ•´ä»£ç å¯ä»¥è®¿é—®ï¼šps2mc-browserã€‚\n01 è§£æSuperBlock SuperBlockç»“æ„å¦‚ä¸‹ï¼Œå¤§å°ä¸º340å­—èŠ‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 struct SuperBlock { char magic[28]; char version[12]; uint16 page_size; uint16 pages_per_cluster; uint16 pages_per_block; uint16 unknown; // ignore uint32 clusters_per_card; uint32 alloc_offset; uint32 alloc_end; uint32 rootdir_cluster; uint32 backup_block1; // ignore uint32 backup_block2; // ignore uint32 unknown[2]; // ignore uint32 ifc_list[32]; uint32 bad_block_list[32]; // ignore byte card_type; byte card_flags; byte unknown; // ignore byte unknown; // ignore }; ä½¿ç”¨struct.unpack()è§£åŒ…ï¼š\n1 struct.Struct(\u0026#34;\u0026lt;28s12sHHH2xLLLL4x4x8x128s128xbbxx\u0026#34;).unpack(byte_val) å¾—åˆ°page_sizeå’Œpages_per_clusterã€‚\n02 è¯»å–pageå’Œcluster æ ¹æ®å…¬å¼è®¡ç®—pageå’Œclusterå¤§å°ï¼š\n1 2 3 self.spare_size = (self.page_size // 128) * 4 # å¤‡ç”¨åŒºåŸŸå­—èŠ‚æ•° self.raw_page_size = self.page_size + self.spare_size # ç®—ä¸Šå¤‡ç”¨åŒºåŸŸçš„pageå­—èŠ‚æ•° self.cluster_size = self.page_size * self.pages_per_cluster # ç°‡å­—èŠ‚æ•° è¯»å–pageå’Œclusterï¼Œspare areaé‡Œçš„å†…å®¹æ˜¯è¢«èˆå¼ƒæ‰çš„ï¼š\n1 2 3 4 5 6 7 8 9 10 def read_page(self, n): # nä¸ºpageç¼–å· offset = self.raw_page_size * n return self.byte_val[offset: offset + self.page_size] def read_cluster(self, n): # nä¸ºclusterç¼–å· page_index = n * self.pages_per_cluster byte_buffer = bytearray() for i in range(self.pages_per_cluster): byte_buffer += self.read_page(page_index + i) return bytes(byte_buffer) 03 æ„å»ºFATçŸ©é˜µ ä»ä¸Šä¸€ç¯‡æ–‡ç« çŸ¥é“FATçŸ©é˜µçš„æ„å»ºæ–¹å¼å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 def __build_fat_matrix(self): # ä»ifc_listæ„å»ºé—´æ¥FAT indirect_fat_matrix = self.__build_matrix(self.ifc_list) # é—´æ¥FATæ˜¯ä¸ªä¸€ç»´æ•°ç»„ indirect_fat_matrix = indirect_fat_matrix.reshape(indirect_fat_matrix.size) # æ’é™¤æ‰0xFFFFFFFFè¿™ç§æœªåˆ†é…çš„ indirect_fat_matrix = [x for x in indirect_fat_matrix if x != Fat.UNALLOCATED] # ä»é—´æ¥FATæ„å»ºç›´æ¥FAT fat_matrix = self.__build_matrix(indirect_fat_matrix) return fat_matrix def __build_matrix(self, cluster_list): # åˆå§‹åŒ–çŸ©é˜µ matrix = np.zeros((len(cluster_list), self.fat_per_cluster), np.uint32) # éå†cluster for index, v in enumerate(cluster_list): # è¯»å‡ºæ¯ä¸ªclusterçš„256ä¸ªFAT cluster_value = self.read_cluster(v) cluster_value_unpacked = np.frombuffer(cluster_value, np.uint32) for index0, v0 in enumerate(cluster_value_unpacked): # ç»™çŸ©é˜µèµ‹å€¼ matrix[index, index0] = v0 return matrix # ç»™å‡ºç°‡ç¼–å·nï¼Œæ‰¾åˆ°å…¶å¯¹åº”çš„FATçš„å€¼ def get_fat_value(self, n): value = self.fat_matrix[(n // self.fat_per_cluster) % self.fat_per_cluster, n % self.fat_per_cluster] # æœ€é«˜ä½ä¸º8ä»£è¡¨æ­£å¸¸ä½¿ç”¨çš„ç°‡ï¼Œå…¶å®ƒå€¼ä»£è¡¨ç°‡æœªåˆ†é…ï¼Œæœ€é«˜ä½ä¸º8æ—¶ï¼Œå–ä½31ä½çš„æ•´å½¢å€¼ return value ^ Fat.ALLOCATED_BIT if value \u0026amp; Fat.ALLOCATED_BIT \u0026gt; 0 else value 04 æ¡ç›®æ•°æ®ç»“æ„ æ¡ç›®æ˜¯æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•çš„å…ƒæ•°æ®ï¼Œæ¡ç›®çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 struct Entry { uint16 mode; uint16 unknown; // ignore uint32 length; char created[8]; uint32 cluster; uint32 dir_entry; // ignore char modified[8]; uint32 attr; // ignore char padding[28]; // ignore char name[32]; char padding[416]; // ignore }; ä½¿ç”¨struct.unpack()è§£åŒ…ï¼š\n1 struct.Struct(\u0026#34;\u0026lt;H2xL8sL4x8s4x28x32s416x\u0026#34;).unpack(byte_val) æ¯ä¸ªæ¡ç›®çš„å¤§å°ä¸º512å­—èŠ‚ï¼Œæ¡ç›®é‡Œæœ€é‡è¦çš„å­—æ®µæ˜¯clusterï¼Œæ ‡è¯†äº†è¯¥æ¡ç›®å¯¹åº”çš„æ–‡ä»¶æˆ–ç›®å½•çš„ç°‡ç¼–å·ã€‚å¦‚æœæœ¬æ¡ç›®æ˜¯ç›®å½•ï¼Œåˆ™å¯¹åº”çš„ç°‡ç¼–å·æ˜¯â€œæ¡ç›®ç°‡â€ï¼›å¦‚æœæœ¬æ¡ç›®æ˜¯æ–‡ä»¶ï¼Œåˆ™å¯¹åº”çš„ç°‡ç¼–å·æ˜¯â€œæ–‡ä»¶ç°‡â€ã€‚å¦ä¸€ä¸ªé‡è¦å­—æ®µæ˜¯lengthï¼Œå¦‚æœæœ¬æ¡ç›®æ˜¯ç›®å½•ï¼Œåˆ™å¯¹åº”çš„æ˜¯ç›®å½•ä¸‹çš„æ¡ç›®æ•°ï¼›å¦‚æœæœ¬æ¡ç›®æ˜¯æ–‡ä»¶ï¼Œåˆ™å¯¹åº”çš„æ˜¯æ–‡ä»¶çš„å­—èŠ‚æ•°ã€‚\n05 è§£æâ€œæ¡ç›®ç°‡â€å’Œâ€œæ•°æ®ç°‡â€ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 # è¯»å–æ¡ç›®ï¼Œæ¡ç›®æ˜¯512å­—èŠ‚ï¼Œä¸€ä¸ªç°‡å¯ä»¥åŒ…å«å¤šä¸ªæ¡ç›® def read_entry_cluster(self, cluster_offset): cluster_value = self.read_cluster(cluster_offset + self.alloc_offset) return Entry.build(cluster_value) # è¯»å–æ•°æ®ï¼Œè¦ä»ç¬¬ä¸€ä¸ªç°‡å¼€å§‹è¯»å–åˆ°æ–‡ä»¶ç»“æŸ def read_data_cluster(self, entry): byte_buffer = bytearray() chain_start = entry.cluster bytes_read = 0 while chain_start != Fat.CHAIN_END: to_read = min(entry.length - bytes_read, self.cluster_size) byte_buffer += self.read_cluster(chain_start + self.alloc_offset)[:to_read] bytes_read += to_read chain_start = self.get_fat_value(chain_start) return bytes(byte_buffer) def build(byte_val): entry_count = len(byte_val) // Entry.__size entries = [] for i in range(entry_count): entries.append(Entry(byte_val[i * Entry.__size: i * Entry.__size + Entry.__size])) return entries 06 è¯»å–å­˜å‚¨å¡ä¸­çš„æ‰€æœ‰æ–‡ä»¶ ä¸Šä¸€ç¯‡æ–‡ç« è¯´è¿‡ï¼Œæ ¹ç›®å½•æ²¡æœ‰æ¡ç›®ï¼Œå®ƒçš„é¦–ä¸ªâ€œæ¡ç›®ç°‡â€åœ¨è¶…çº§å—çš„rootdir_clusterä¸­ï¼Œå®ƒçš„â€œåŒ…å«æ¡ç›®æ•°â€åœ¨.è¿™ä¸ªæ¡ç›®ä¸­ã€‚\nè¦è¯»å–å­˜å‚¨å¡ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œç¬¬ä¸€æ­¥æ˜¯è§£ææ ¹ç›®å½•ä¸‹æ‰€æœ‰æ¡ç›®ï¼Œå†è§£ææ¡ç›®ä¸‹æ‰€æœ‰æ–‡ä»¶ã€‚å› æ­¤åªè¦å¾ªç¯è°ƒç”¨ä»¥ä¸‹æ–¹æ³•ï¼š\n1 2 3 4 5 6 7 8 9 10 def find_sub_entries(self, parent_entry): chain_start = parent_entry.cluster sub_entries = [] while chain_start != Fat.CHAIN_END: entries = self.read_entry_cluster(chain_start) for e in entries: if len(sub_entries) \u0026lt; parent_entry.length: sub_entries.append(e.unpack()) chain_start = self.get_fat_value(chain_start) return [x for x in sub_entries if not x.name.startswith(\u0026#39;.\u0026#39;)] ç»“æœå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 BISCPS-15119sv01 GameData BISCPS-15119sv01 icon00.ico icon.sys BISCPS-15116sv01 GameData BISCPS-15116sv01 icon00.ico icon.sys BASLUS-21441DBZT2 icon.sys dbzsn.ico BASLUS-21441DBZT2 ... 07 å¯¼å‡ºæ¸¸æˆå­˜æ¡£ æ—¢ç„¶æ‰€æœ‰æ–‡ä»¶æ¡ç›®éƒ½å·²ç»è¯»å–å‡ºæ¥äº†ï¼Œæˆ‘ä»¬åªè¦å†™ä¸ªæ–¹æ³•ï¼Œæ ¹æ®è¾“å…¥çš„æ¸¸æˆåç§°ï¼Œå³å¯å¯¼å‡ºç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚\n1 2 3 4 5 6 7 8 9 def export(self, name, dest): dir_path = dest + os.sep + name if not os.path.exists(dir_path): os.mkdir(dir_path) entries = self.lookup_entry_by_name(name) for e in entries: if e.is_file(): with open(dir_path + os.sep + e.name, \u0026#39;wb\u0026#39;) as f: f.write(self.ps2mc.read_data_cluster(e)) 08 ç»“å°¾ è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥æŠŠä¸€ä¸ªæ¸¸æˆçš„å­˜æ¡£ä»å­˜å‚¨å¡ä¸­å¯¼å‡ºæ¥äº†ã€‚å¦‚æœä½ æœ‰pythonè¿è¡Œç¯å¢ƒï¼Œå¯ä»¥ç›´æ¥è¿è¡Œæ–‡ç« ä¸€å¼€å§‹æä¾›çš„githubé“¾æ¥é‡Œçš„ä»£ç ã€‚\nä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†åˆ†æä¸€ä¸‹æ¯ä¸ªå­˜æ¡£æ–‡ä»¶é‡Œçš„icon.syså’Œxxx.icoæ–‡ä»¶ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶æ˜¯å­˜æ¡£3dç‰¹æ•ˆçš„æ•°æ®æ–‡ä»¶ã€‚\n09 å‚è€ƒæ–‡çŒ® Ross Ridge - PlayStation 2 Memory Card File System Florian MÃ¤rkl - mymcplus ","permalink":"https://babyno.top/posts/2023/09/exporting-file-from-ps2-memcard/","summary":"ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬è§£æäº†PS2å­˜å‚¨å¡çš„æ–‡ä»¶ç³»ç»Ÿï¼Œè¿™æ¬¡ç›´æ¥å®æˆ˜ï¼Œç¼–å†™pythonä»£ç å¯¼å‡ºæŒ‡å®šçš„æ¸¸æˆå­˜æ¡£ã€‚æœ¬ç¯‡æ–‡ç« å®Œæ•´ä»£ç å¯ä»¥è®¿é—®ï¼šps2mc-b","title":"ä»PS2è®°å¿†å¡ä¸­å¯¼å‡ºå­˜æ¡£æ–‡ä»¶"},{"content":" 01 å‰è¨€ ä½œä¸ºä¸€ä¸ª80åçš„æ¸¸æˆè€ç©å®¶ï¼ŒPS2æ¸¸æˆæœºåœ¨æˆ‘å¿ƒä¸­ä¸€ç›´æœ‰ç€ç‰¹æ®Šçš„åœ°ä½ã€‚æ—¶è‡³ä»Šæ—¥ï¼Œå·²ç»è¿‡å»äº†20å¤šå¹´ï¼Œç„¶è€Œï¼Œæœ€è¿‘æˆ‘å› ä¸ºæ¨¡æ‹Ÿå™¨çš„ç¼˜æ•…é‡æ–°æ¥è§¦åˆ°äº†å®ƒã€‚åœ¨é‡æ¸©äº†ä¸€æ®µæ—¶é—´æ¸¸æˆåï¼Œæˆ‘çªå‘å¥‡æƒ³ï¼Œèƒ½å¦é€šè¿‡ç°åœ¨çš„çŸ¥è¯†æ¥å›å¿†å¹´å°‘æ—¶çš„è‡ªå·±ï¼Ÿäºæ˜¯ï¼Œæˆ‘å¼€å§‹äº†è¿™ä¸€ç³»åˆ—æ–‡ç« çš„åˆ›ä½œï¼Œä»åˆ†æPS2å­˜å‚¨å¡çš„æ–‡ä»¶ç³»ç»Ÿå¼€å§‹ï¼Œé€æ­¥æ·±å…¥çš„è§£æå…¶æ–‡ä»¶å­˜å‚¨æœºåˆ¶åŠæ¯ä¸ªæ¸¸æˆçš„å­˜æ¡£æ–‡ä»¶ã€‚æˆ‘çš„ç›®æ ‡æ˜¯ï¼Œæœ€ç»ˆé€šè¿‡Pythonå’ŒOpenGLï¼Œæ¨¡æ‹Ÿå‡ºæ¸¸æˆå­˜æ¡£ä¸­ç»å…¸çš„3Däººç‰©æ—‹è½¬æ•ˆæœï¼Œä»¥æ­¤æ¥çºªå¿µè¿™ä¸ªæ›¾ç»é™ªä¼´æˆ‘åº¦è¿‡é’æ˜¥æ—¶å…‰çš„ç»å…¸æ¸¸æˆæœºã€‚\nè¿™æ˜¯ç³»åˆ—çš„ç¬¬ä¸€ç¯‡ä½œå“ï¼Œè§£æPS2å­˜å‚¨å¡çš„æ–‡ä»¶ç³»ç»Ÿã€‚\n02 è¯æ±‡è¡¨ å­˜å‚¨å¡ æŒ‡PS2å®ä½“æœºä½¿ç”¨çš„ä¸“ç”¨è®°å¿†å¡ä»‹è´¨ï¼Œä½¿ç”¨æ—¶æ’åœ¨ä¸»æœºä¸Šï¼Œä¸ä¸»æœºæ˜¯ç›¸äº’ç‹¬ç«‹çš„ä¸¤ä¸ªè®¾å¤‡ã€‚ NANDé—ªå­˜ PS2å­˜å‚¨å¡ä½¿ç”¨çš„å†…éƒ¨èŠ¯ç‰‡ï¼Œä¸€ç§éæ˜“å¤±æ€§å­˜å‚¨è®¾å¤‡ã€‚ å­˜å‚¨å¡æ–‡ä»¶ æŒ‡PS2æ¨¡æ‹Ÿå™¨ä½¿ç”¨çš„å­˜å‚¨å¡é•œåƒæ–‡ä»¶ï¼Œä¿å­˜åœ¨æ¨¡æ‹Ÿå™¨æ‰€åœ¨çš„ç”µè„‘ç£ç›˜ä¸Šï¼Œä»¥.ps2ä¸ºåç¼€ã€‚æ˜¯æˆ‘ä»¬è¿™ç¯‡æ–‡ç« è§£æçš„ç›®æ ‡ã€‚ SuperBlock è¶…çº§å—ï¼Œä½äºæ–‡ä»¶ç³»ç»Ÿå¼€å¤´çš„å›ºå®šéƒ¨åˆ†ï¼Œç”±å­˜å‚¨å¡æ ¼å¼åŒ–æ—¶å†™å…¥ï¼Œä¸å¯æ›´æ”¹ï¼Œè®°å½•äº†å­˜å‚¨å¡çš„åŸºæœ¬ç¡¬ä»¶æŒ‡æ ‡ã€‚ page é¡µï¼Œæ–‡ä»¶ç³»ç»Ÿçš„æœ€å°è¯»å†™å•å…ƒï¼Œé¡µçš„å¤§å°å®šä¹‰äºè¶…çº§å—ä¸­ã€‚ cluster ç°‡ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­çš„æœ€å°åˆ†é…å•ä½ï¼Œè¦ä¿å­˜ä¸€ä¸ªæ–‡ä»¶è‡³å°‘éœ€è¦ä¸€ä¸ªç°‡ã€‚ç°‡çš„å¤§å°å®šä¹‰äºè¶…çº§å—ä¸­ã€‚ block å—ï¼Œæ–‡ä»¶ç³»ç»Ÿçš„æœ€å°æ“¦é™¤å•ä½ï¼Œå—çš„å¤§å°å®šä¹‰äºè¶…çº§å—ä¸­ã€‚ æ“¦é™¤ é—ªå­˜åˆå§‹åŒ–æ—¶é¡µä¸­çš„æ¯ä¸€ä¸ªbitéƒ½ä¸º1ï¼Œå†™æ“ä½œå¯ä»¥å°†bitç½®ä¸º0ï¼Œä½†æ— æ³•æ¢å¤ä¸º1ã€‚æ“¦é™¤æ˜¯å°†bitæ¢å¤æˆ1çš„å”¯ä¸€é€”å¾„ï¼Œä½†ç¼ºç‚¹æ˜¯æ“¦é™¤ä»¥å—ä¸ºå•ä½ï¼Œå“ªæ€•åªæ˜¯ä¿®æ”¹ä¸€ä½æ•°æ®ï¼Œä¹Ÿå¾—å…ˆæ“¦é™¤ä¸€ä¸ªå—ï¼Œç„¶åå†ç”¨å†™æ“ä½œæŠŠå—çš„æ¯ä¸€é¡µæ¢å¤ã€‚è¿™ä¹Ÿæ˜¯PS2æ¸¸æˆå­˜æ¡£æ—¶æ™®éè¾ƒæ…¢çš„åŸå› ã€‚ FAT æ–‡ä»¶åˆ†é…è¡¨ï¼Œä¸FAT16å’ŒFAT32æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶åˆ†é…è¡¨ç±»ä¼¼ã€‚ç”±äºæ–‡ä»¶ä¼šä¿å­˜åœ¨å¤šä¸ªç°‡ä¸Šï¼Œè€Œç°‡å¯ä»¥æ˜¯ä¸è¿ç»­çš„ï¼Œä¸ºäº†ç¡®ä¿åœ¨å­˜å–æ–‡ä»¶æ—¶èƒ½å¤Ÿæ£€ç´¢åˆ°æ‰€æœ‰è¿ç»­æˆ–ä¸è¿ç»­çš„ç°‡åœ°å€ï¼Œæ–‡ä»¶åˆ†é…è¡¨é‡‡ç”¨äº†â€œç°‡é“¾â€è¿™ç§é“¾è¡¨çš„è®°å½•æ–¹å¼ã€‚ ifc indirect FAT clusteré—´æ¥FATç°‡ï¼Œæ˜¯ä¸€ä¸ªç°‡ï¼Œå…¶ä¸­ä¿å­˜æœ‰å­˜å‚¨å¡ä¸ŠFATç°‡çš„åˆ—è¡¨ã€‚ ifc_list ifcçš„æ•°ç»„ï¼Œå®šä¹‰äºè¶…çº§å—ä¸­ã€‚é€šè¿‡å®ƒå¯ä»¥æ‰¾åˆ°ifcç°‡ã€‚ ECC çº é”™ç ï¼ˆError Correction Codeï¼‰ï¼Œé—ªå­˜ç‰¹æ€§ï¼Œå†™å…¥pageæ—¶éœ€è¦å¯¹æ¯ä¸€é¡µè¿›è¡Œçº é”™ç è®¡ç®—ï¼Œå¹¶å†™å…¥spare areaä¸­ã€‚ spare area å¤‡ç”¨åŒºåŸŸï¼Œä¸ºæ¯ä¸€ä¸ªé¡µä¿å­˜ECCçš„ä¸€æ®µç©ºé—´ã€‚ entry æ¡ç›®ï¼Œå­˜å‚¨å¡ä¸Šä¿å­˜çš„æ–‡ä»¶æˆ–ç›®å½•çš„åŸºæœ¬ä¿¡æ¯å•å…ƒï¼Œæ¯”å¦‚ï¼šæ–‡ä»¶ï¼ˆç›®å½•ï¼‰åã€å¤§å°ã€ç¬¬ä¸€ä¸ªç°‡ç¼–å·ç­‰ã€‚ 03 æ–‡ä»¶ç³»ç»Ÿç»“æ„ æ³¨ï¼šè¿™é‡Œç”¨æ ‡å‡†çš„8Må­˜å‚¨å¡ä¸¾ä¾‹ã€‚\n3.1 æ•°æ®ç»“æ„ ä»è¶…çº§å—ä¸­å¯å¾—çŸ¥é¡µçš„å¤§å°æ˜¯512å­—èŠ‚ï¼Œç°‡çš„å¤§å°æ˜¯2ä¸ªé¡µã€‚spare areaå¯ä»¥æ ¹æ®å…¬å¼(page_len / 128) * 4å¾—åˆ°ï¼Œæ˜¯16å­—èŠ‚ï¼Œåˆ™æ–‡ä»¶ç³»ç»ŸåŸºæœ¬æ•°æ®ç»“æ„å¦‚å›¾ï¼š\n3.2 é€»è¾‘ç»“æ„ äº†è§£äº†æœ€åŸºæœ¬çš„æ•°æ®ç»“æ„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åˆ’åˆ†ä¸€ä¸‹å­˜å‚¨å¡çš„é€»è¾‘ç»“æ„ã€‚å¦‚ä¸‹å›¾ï¼Œä¸€å—å­˜å‚¨å¡å¤§è‡´èƒ½åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªé€»è¾‘åŒºå—ã€‚ï¼ˆé»‘ç™½éƒ¨åˆ†æœ¬æ–‡ä¸æ¶‰åŠï¼Œå¯ä»¥å¿½ç•¥ã€‚ï¼‰æ³¨æ„ï¼šç»„æˆé€»è¾‘åŒºå—çš„æœ€å°å•ä½æ˜¯ç°‡ã€‚\nè¶…çº§å— ä½äºæ•´ä¸ªæ–‡ä»¶å¼€å¤´ï¼ˆä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªç°‡ï¼‰çš„å‰340ä¸ªå­—èŠ‚ï¼Œè¿™æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­å”¯ä¸€å…·æœ‰å›ºå®šä½ç½®çš„éƒ¨åˆ†ã€‚ä¸‹å›¾ç¤ºæ„äº†ä¸€ä¸ªå­˜å‚¨å¡æ–‡ä»¶çš„è¶…çº§å—ã€‚\næ³¨ï¼šPS2å­˜å‚¨å¡çš„å­—èŠ‚åºæ˜¯å°ç«¯åºLittle-endianã€‚\nOffset Name Length Default Description 0 magic byte[28] - å›ºå®šå­—ç¬¦ä¸²\u0026quot;Sony PS2 Memory Card Format\u0026quot;ï¼Œ è¡¨æ˜è¯¥å¡å·²æˆåŠŸåˆå§‹åŒ– 28 version byte[12] 1.X.0.0 ç‰ˆæœ¬å· 40 page_len uint16 512 pageçš„å¤§å°(ä»¥å­—èŠ‚ä¸ºå•ä½) 42 pages_per_cluster uint16 2 ç°‡ä¸­çš„é¡µæ•° 44 pages_per_block uint16 16 å—ä¸­çš„é¡µæ•° 46 - uint16 0xFF00 æœªçŸ¥ 48 clusters_per_card uint32 8192 å¡çš„æ€»å¤§å°(ä»¥ç°‡ä¸ºå•ä½) 52 alloc_offset uint32 41 ç¬¬ä¸€ä¸ªå¯åˆ†é…ç°‡ 56 alloc_end uint32 8135 æœ€åä¸€ä¸ªå¯åˆ†é…ç°‡ 60 rootdir_cluster uint32 0 æ ¹ç›®å½•çš„ç¬¬ä¸€ä¸ªç°‡ï¼Œç›¸å¯¹äºalloc_offset 64 backup_block1 uint32 1023 æœ¬æ–‡æ— ç”¨ 68 backup_block2 uint32 1022 æœ¬æ–‡æ— ç”¨ 80 ifc_list uint32[32] 8 é—´æ¥ FAT ç°‡åˆ—è¡¨ï¼Œåœ¨æ ‡å‡† 8M å¡ä¸Šåªæœ‰ä¸€ä¸ªé—´æ¥ FAT ç°‡ 208 bad_block_list uint32[32] -1 æœ¬æ–‡æ— ç”¨ 336 card_type byte 2 å¿…é¡»æ˜¯2ï¼Œè¯´æ˜è¿™æ˜¯ä¸€å¼ PS2å­˜å‚¨å¡ 337 card_flags byte 0x52 å­˜å‚¨å¡çš„ç‰©ç†ç‰¹æ€§ å­—æ®µpage_lenã€pages_per_clusterã€pages_per_blockå’Œcluster_per_cardå®šä¹‰æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬å‡ ä½•ç»“æ„ã€‚å¯ä»¥ä½¿ç”¨ifc_listè®¿é—®FATï¼Œrootdir_clusterç»™å‡ºæ ¹ç›®å½•çš„ç¬¬ä¸€ä¸ªç°‡ã€‚FATå’Œç›®å½•é¡¹ä¸­çš„ç°‡åç§»é‡éƒ½ä¸alloc_offsetç›¸å…³ã€‚\nFAT æ–‡ä»¶åˆ†é…è¡¨æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œå½“ä½ æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶çš„èµ·å§‹ç°‡æ—¶ï¼Œä½ æƒ³è±¡æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹xç”¨æ¥è¯»å–è¿™ä¸ªç°‡é‡Œçš„å†…å®¹ï¼ˆå³æ•°æ®ï¼‰ï¼Œçº¿ç¨‹yå»FATé‡Œå¯»æ‰¾ä¸‹ä¸€ä¸ªç°‡ï¼Œäº¤ç”±xè¯»å–ï¼Œç„¶åä¸æ–­å¾ªç¯ï¼Œå½“ç„¶ä¸¤ä¸ªçº¿ç¨‹ä¸æ˜¯å¿…é¡»çš„ã€‚è¿™é‡Œå¼•ç”¨ä¸€å¼ å›¾è¯´æ˜ä¸€ä¸‹è¿™ç§å·¥ä½œæ–¹å¼ï¼š\nå·²çŸ¥æ–‡ä»¶Aï¼Œèµ·å§‹ç°‡æ˜¯8 çº¿ç¨‹xå»ç°‡8è¯»å–ç¬¬ä¸€å—æ•°æ®A0 çº¿ç¨‹yå»FATæŸ¥æ‰¾8çš„ä¸‹ä¸€ä¸ªç°‡æ˜¯13 çº¿ç¨‹xç»§ç»­è¯»å–ç°‡13çš„æ•°æ®A1 çº¿ç¨‹yå»FATæŸ¥æ‰¾13çš„ä¸‹ä¸€ä¸ªç°‡æ˜¯7 ä¸æ–­å¾ªç¯ å›¾ç‰‡æ¥æºï¼šhttps://www.slideserve.com/yahto/file-system-implementation\nç›´æ¥FAT ç”±å‰æ–‡å¯ä»¥å¾—çŸ¥ï¼Œç›´æ¥FATå’Œé—´æ¥FATéƒ½æ˜¯ä¿å­˜åœ¨ç°‡é‡Œçš„ã€‚ç°‡é‡Œçš„æ•°æ®å¿…é¡»æœ‰ä¸€ä¸ªè‰¯å¥½çš„ç»“æ„ï¼Œæ‰èƒ½ä½¿æˆ‘ä»¬ç®€å•çš„è§£ææˆFATé“¾è¡¨ã€‚FATåœ¨ç°‡é‡Œçš„ç»“æ„å¯ä»¥æƒ³è±¡æˆé•¿è¿™æ ·ï¼š\nè¿™æ˜¯ä¸€ä¸ªçŸ©é˜µMï¼Œè¡Œå®šä¹‰ä¸ºFATæ‰€åœ¨çš„ç°‡ï¼Œåˆ—å®šä¹‰ä¸ºæ¯ä¸ªFATç°‡é‡Œçš„æ•°æ®ã€‚æ¯ä¸ªFATç°‡ï¼Œä¿å­˜çš„éƒ½æ˜¯4å­—èŠ‚32ä½çš„æ•´å½¢æ•°ç»„ï¼Œæ•°é‡ä¸º1024 / 4 = 256ä¸ªï¼Œå› æ­¤çŸ©é˜µæœ‰256åˆ—ã€‚FATä¸€å…±æœ‰å¤šå°‘ä¸ªç°‡å‘¢ï¼Ÿè¿™ç‚¹å¯ä»¥åœ¨é—´æ¥FATçš„ç°‡ä¸­è§£æå‡ºæ¥ï¼Œæˆ‘ä»¬ä¹‹åå†è®²ã€‚åœ¨è¿™é‡ŒFATä¸€å…±å æ®äº†32ä¸ªç°‡ï¼Œå› æ­¤çŸ©é˜µæœ‰32è¡Œã€‚\nMçŸ©é˜µçš„å¤§å°ä¸º32 * 256 = 8192ï¼Œæ„å‘³ç€è¿™ä¸ªFATå¯ä»¥ç®¡ç†8192ä¸ªç°‡ã€‚å‡è®¾ç°åœ¨è¦æ‰¾ç°‡nåœ¨çŸ©é˜µä¸­çš„ä½ç½®rowå’Œcolumnï¼Œå¯ä»¥æ ¹æ®ç®€å•çš„è®¡ç®—å¾—å‡ºï¼š\n1 2 row = (n // 256) % 256 column = n % 256 æ—¢ç„¶å·²ç»è®¡ç®—å‡ºäº†ä½ç½®ï¼Œé‚£å°±å¯ä»¥å–åˆ°å¯¹åº”çš„å€¼äº†ï¼Œæ²¡é”™ï¼Œè¿™ä¸ªå€¼?å°±æ˜¯ä¸‹ä¸€ä¸ªç°‡ã€‚é€šè¿‡ä¸æ–­å¾ªç¯ï¼Œç›´åˆ°å–åˆ°çš„å€¼ä¸º0xFFFFFFFFï¼Œè¡¨ç¤ºç°‡é“¾åˆ°ç»“å°¾äº†ï¼Œä¸éœ€è¦å†æŸ¥æ‰¾äº†ã€‚\næ³¨ï¼šFATè¡¨é‡Œå‚¨å­˜çš„å€¼ä¸º32ä½ï¼Œæœ€é«˜ä½ä¸º8ä»£è¡¨æ­£å¸¸ä½¿ç”¨çš„ç°‡ï¼Œå…¶å®ƒå€¼ä»£è¡¨ç°‡æœªåˆ†é…ï¼Œæœ€é«˜ä½ä¸º8æ—¶ï¼Œå–ä½31ä½çš„æ•´å½¢å€¼ã€‚å€¼ä¸º0xFFFFFFFFä»£è¡¨å·²æ˜¯ç°‡é“¾æœ«å°¾ã€‚\né—´æ¥FAT å‰æ–‡ç•™äº†ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆFATå æœ‰äº†32ä¸ªç°‡ï¼Ÿ\nåœ¨è¶…çº§å—ä¸­æœ‰ä¸€ä¸ªå­—æ®µifc_listï¼Œæ˜¯ä¸€ä¸ª4å­—èŠ‚32ä½çš„æ•´å½¢æ•°ç»„ï¼Œå†æƒ³è±¡ä¸€ä¸‹ä¸Šé¢å‡ºç°çš„çŸ©é˜µã€‚ifc_listæ˜¯ä¸€ä¸ªåªæœ‰ä¸€è¡Œçš„çŸ©é˜µï¼Œè™½ç„¶å®ƒæœ‰32ä¸ªå…ƒç´ ï¼Œä½†åªæœ‰ç¬¬ä¸€ä¸ªæœ‰å€¼ï¼Œå…¶å€¼8å³é—´æ¥FATç°‡ifcã€‚å°†ç°‡8çš„å†…å®¹æŒ‰ç…§ä¸Šæ–‡çš„æ–¹æ³•è§£æå‡ºæ¥ï¼Œå†å½¢æˆä¸€ä¸ªçŸ©é˜µï¼Œè¡Œæ˜¯ifc_listçš„ä¸ªæ•°ï¼Œç†è®ºä¸Šæ˜¯32ï¼Œä½†ç”±äºåªæœ‰1ä¸ªå…ƒç´ ï¼Œå› æ­¤è¿™ä¸ªçŸ©é˜µçš„è¡Œä¹Ÿä¸º1ã€‚çŸ©é˜µçš„åˆ—ä¾ç„¶æ˜¯256ã€‚è§£æå…¶ä¸­çš„å€¼ï¼Œå¯ä»¥å¾—åˆ°FATæ‰€åœ¨çš„ç°‡ä¸º9åˆ°40ï¼Œå³32ä¸ªã€‚\nå¯åˆ†é…ç°‡ æ˜¯ä¸€ä¸ªèŒƒå›´ï¼Œä»alloc_offsetå¼€å§‹åˆ°alloc_endç»“æŸã€‚é™¤å»è¶…çº§å—ã€FATã€ä¿ç•™ç°‡ç­‰çš„ä½ç½®ï¼Œæ‰€æœ‰çš„æ¸¸æˆå­˜æ¡£éƒ½ä½äºå¯åˆ†é…ç°‡å†…ã€‚\n04 æ–‡ä»¶å’Œç›®å½• æ¥ç€æˆ‘ä»¬è¦ç ”ç©¶ä¸‹å¯åˆ†é…ç°‡é‡Œï¼Œæ¯ä¸ªç°‡éƒ½ä¿å­˜äº†äº›ä»€ä¹ˆä¸œè¥¿ï¼Ÿç®€å•æ¥è¯´ï¼Œå¯åˆ†é…ç°‡é‡Œåªæœ‰ä¸¤ç§ç°‡ï¼šâ€œæ¡ç›®ç°‡â€å’Œâ€œæ•°æ®ç°‡â€ã€‚ä¿å­˜æ¡ç›®çš„ç°‡ç§°ä¸ºâ€œæ¡ç›®ç°‡â€ï¼Œä¿å­˜æ•°æ®çš„ç°‡ç§°ä¸ºâ€œæ•°æ®ç°‡â€ã€‚\n4.1 æ¡ç›® æ¯ä¸ªç›®å½•æˆ–æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªâ€œæ¡ç›®â€ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å…ƒæ•°æ®ï¼Œä¿å­˜æœ‰æ–‡ä»¶åã€å¤§å°ã€åˆ›å»ºå’Œä¿®æ”¹æ—¶é—´ç­‰å±æ€§ã€‚æ¯ä¸ªâ€œæ¡ç›®â€çš„é•¿åº¦ä¸º 512 å­—èŠ‚ï¼Œå› æ­¤æ¯ä¸ª 1024 ç°‡ä¸­åªèƒ½å®¹çº³ä¸¤ä¸ªâ€œæ¡ç›®â€ã€‚â€œæ¡ç›®ç°‡â€ä¸ä¼šä¿å­˜æ–‡ä»¶æ•°æ®ï¼Œå³ä½¿â€œæ¡ç›®ç°‡â€é‡Œåªæœ‰ä¸€ä¸ªâ€œæ¡ç›®â€ã€‚\né™¤äº†æ ¹ç›®å½•æ²¡æœ‰rootè¿™ä¸ªâ€œæ¡ç›®â€å¤–ï¼Œæ¯ä¸ªç›®å½•éƒ½æœ‰ä»¥è‡ªå·±çš„ç›®å½•åå‘½åçš„â€œæ¡ç›®â€ï¼Œæ¯ä¸ªæ–‡ä»¶ä¹Ÿæœ‰ä»¥è‡ªå·±çš„æ–‡ä»¶åå‘½åçš„â€œæ¡ç›®â€ï¼Œâ€œæ¡ç›®â€çš„ç»“æ„å¦‚ä¸‹è¡¨ï¼š\nOffset Name Length Description 0 mode uint16 æ ‡è¯†è¯¥æ–‡ä»¶çš„å±æ€§ 4 length uint32 å¦‚æœæ˜¯æ–‡ä»¶ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼›å¦‚æœæ˜¯ç›®å½•ï¼Œä»¥é¡¹ä¸ºå•ä½ã€‚ 8 created byte[8] åˆ›å»ºæ—¶é—´ 16 cluster uint32 æ¡ç›®å¯¹åº”çš„ç¬¬ä¸€ä¸ªç°‡ï¼Œæ˜¯ç›¸å¯¹äºalloc_offsetçš„ç›¸å¯¹å€¼ã€‚ 20 dir_entry uint32 æ— ç”¨ 24 modified byte[8] ä¿®æ”¹æ—¶é—´ 32 attr uint32 ç”¨æˆ·å±æ€§ 36 name byte[32] æ–‡ä»¶åï¼Œx00ä»¥åçš„éœ€æˆªæ–­ modeå­—æ®µè¯·å‚è€ƒï¼šhttps://www.ps2savetools.com/ps2memcardformat.html ã€‚æ˜¯ä¸€ä¸ª4å­—èŠ‚æ•´å½¢æ•°ï¼Œæ¯ä¸ªå­—èŠ‚ç”¨å¯¹åº”çš„æ©ç æ¯”å¯¹ï¼Œå³å¯è¯†åˆ«â€œæ¡ç›®â€å¯¹åº”çš„æ–‡ä»¶ç±»å‹ã€‚æ¯”å¦‚ï¼š0x8427ä»£è¡¨ä¸€ä¸ªç›®å½•ï¼Œ0x8497ä»£è¡¨ä¸€ä¸ªæ–‡ä»¶ã€‚ clusterå­—æ®µä»£è¡¨äº†â€œæ¡ç›®â€çš„ç¬¬ä¸€ä¸ªç°‡ã€‚å¦‚æœæœ¬æ¡ç›®æ˜¯ç›®å½•ï¼Œåˆ™è¿™ä¸ªç°‡æŒ‡å‘çš„æ˜¯å½“å‰ç›®å½•çš„ä¸‹ä¸€ä¸ªâ€œæ¡ç›®ç°‡â€ï¼›å¦‚æœæœ¬æ¡ç›®æ˜¯æ–‡ä»¶ï¼Œåˆ™è¿™ä¸ªç°‡æŒ‡å‘çš„æ˜¯æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªâ€œæ•°æ®ç°‡â€ã€‚ æ¯ä¸ªç›®å½•ä¸‹çš„ç¬¬ä¸€ä¸ªâ€œæ¡ç›®ç°‡â€ä¸€å®šæ˜¯åä¸º.å’Œ..çš„ä¸¤ä¸ªç›®å½•ï¼Œè¿™ä¸¤ä¸ªç›®å½•é¡¹ä»£è¡¨å½“å‰ç›®å½•å’Œçˆ¶ç›®å½•ï¼Œå°±åƒåœ¨Unixä¸­ä¸€æ ·ã€‚ ç›®å½•ä¸‹æœ‰å‡ ä¸ªâ€œæ¡ç›®â€ä»¥åŠæ–‡ä»¶æœ‰å‡ ä¸ªå­—èŠ‚éƒ½æ˜¯ç”±lengthå­—æ®µå†³å®šçš„ï¼Œå½“ä½ æŒ‰ç…§â€œç°‡é“¾â€è¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œéœ€è¦è‡ªå·±è®°å½•æœ€åä¸€ä¸ªç°‡çš„å“ªé‡Œæ˜¯æœ€åä¸€ä¸ªå­—èŠ‚ã€‚ 05 ç»“å°¾ è‡³æ­¤ï¼Œç›¸ä¿¡å¤§å®¶å¯¹ä¸€ä¸ªps2å­˜å‚¨æ–‡ä»¶æœ‰äº†å¤§è‡´è®¤è¯†äº†å§ã€‚æœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªç¨‹åºè§£æä¸‹äº†ã€‚ç¨åæˆ‘ä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œé™„ä¸Šæœ¬ç¯‡æ–‡ç« æ¶‰åŠçš„æºä»£ç ã€‚\nä¸‹ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬å°†å¼€å§‹æŠŠæ¸¸æˆå­˜æ¡£ä»å­˜å‚¨å¡é‡Œå¯¼å‡ºæ¥ï¼Œçœ‹çœ‹æ¯ä¸ªæ¸¸æˆå­˜æ¡£éƒ½æœ‰å“ªäº›æ–‡ä»¶ã€‚\n06 å‚è€ƒæ–‡çŒ® æœ¬æ–‡ä¸»è¦å‚è€ƒäº†å¦‚ä¸‹æ–‡ç« ï¼Œåœ¨æ­¤è¡¨ç¤ºæ„Ÿè°¢ğŸ™ï¼š\nRoss Ridge - PlayStation 2 Memory Card File System ","permalink":"https://babyno.top/posts/2023/09/parsing-ps2-memcard-file-system/","summary":"01 å‰è¨€ ä½œä¸ºä¸€ä¸ª80åçš„æ¸¸æˆè€ç©å®¶ï¼ŒPS2æ¸¸æˆæœºåœ¨æˆ‘å¿ƒä¸­ä¸€ç›´æœ‰ç€ç‰¹æ®Šçš„åœ°ä½ã€‚æ—¶è‡³ä»Šæ—¥ï¼Œå·²ç»è¿‡å»äº†20å¤šå¹´ï¼Œç„¶è€Œï¼Œæœ€è¿‘æˆ‘å› ä¸ºæ¨¡æ‹Ÿå™¨çš„ç¼˜æ•…é‡æ–°æ¥è§¦","title":"è§£æPS2è®°å¿†å¡æ–‡ä»¶ç³»ç»Ÿ"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nThe following HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code Code Blocks Inline Code This is Inline Code\nOnly pre Code block with backticks 1 2 3 4 5 6 7 8 9 10 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34; /\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block with backticks and language specified 1 2 3 4 5 6 7 8 9 10 11 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34; /\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;meta name=\u0026#34;description\u0026#34; content=\u0026#34;Sample article showcasing basic Markdown syntax and formatting for HTML elements.\u0026#34;\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block with Hugo\u0026rsquo;s internal highlight shortcode 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL+ALT+Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nmermaid test 1 2 3 4 5 sequenceDiagram participant Alice participant Bob Alice-\u0026gt;\u0026gt;Bob: Hi Bob Bob-\u0026gt;\u0026gt;Alice: Hi Alice The above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"https://babyno.top/posts/2019/03/hello-world/","summary":"\u003cp\u003eThis article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\u003c/p\u003e","title":"Hello World"}]